ğŸ“˜ MANUAL â€“ EjecuciÃ³n y AutomatizaciÃ³n del Script auto-backup-zip-nas.ps1
ğŸŸ¦ 1. EJECUTAR EL SCRIPT MANUALMENTE DESDE POWERSHELL
1.1. Requisitos

Antes de ejecutar el script, verifica:

âœ” El archivo existe en:
C:\Scripts\auto-backup-zip-nas.ps1

âœ” PowerShell se abre como Administrador.

1.2. Abrir PowerShell como Administrador

Clic en Inicio

Escribe: PowerShell

Clic derecho â†’ Ejecutar como administrador

1.3. Permitir ejecuciÃ³n temporal del script

Windows Server bloquea scripts por defecto, asÃ­ que usa:

powershell -ExecutionPolicy Bypass -File "C:\Scripts\auto-backup-zip-nas.ps1"


Esto ejecuta el script inmediatamente usando la polÃ­tica Bypass.

1.4. Verificar resultados

Al terminar, revisa en el NAS:

\\182.1.1.23\quifatex\Respaldos BDD_SERQ\
   BACKUPS MES AÃ‘O\
       FECHA\
           *.zip


Si aparecen los ZIP, la ejecuciÃ³n fue correcta.

ğŸŸ© 2. CREAR UNA TAREA AUTOMÃTICA EN WINDOWS SERVER (7 AM DIARIO)
2.1. Abrir el Programador de Tareas

Tres mÃ©todos:

âœ” Inicio â†’ escribe Programador de tareas
âœ” Panel de control â†’ Herramientas administrativas
âœ” Ejecutar â†’ taskschd.msc

2.2. Crear una nueva tarea

En el panel derecho:

â¡ï¸ Crear tareaâ€¦
(NOT â€œCrear tarea bÃ¡sicaâ€¦â€)

2.3. ConfiguraciÃ³n de la pestaÃ±a â€œGeneralâ€

Nombre:
Tarea Backup ZIP NAS

Ejecutar tanto si el usuario iniciÃ³ sesiÃ³n como si no âœ”

Ejecutar con los privilegios mÃ¡s altos âœ”

Configurar para: Windows Server (tu versiÃ³n)

2.4. ConfiguraciÃ³n de la pestaÃ±a â€œDesencadenadoresâ€

Clic en Nuevoâ€¦

Configurar:

Iniciar la tarea: SegÃºn una programaciÃ³n

ConfiguraciÃ³n: Diario

Iniciar: 07:00:00 AM

Repetir: No

Vence: Nunca

Clic en Aceptar

2.5. ConfiguraciÃ³n de la pestaÃ±a â€œAccionesâ€

Clic en Nuevoâ€¦

Configurar:

AcciÃ³n: Iniciar un programa

Programa o script:

powershell.exe


Agregar argumentos:

-ExecutionPolicy Bypass -File "C:\Scripts\auto-backup-zip-nas.ps1"


Clic en Aceptar

2.6. PestaÃ±a â€œCondicionesâ€ (Opcional pero recomendable)

Desmarcar:
Iniciar la tarea solo si el equipo estÃ¡ conectado a corriente alterna

Marcar:
Reactivar el equipo para ejecutar esta tarea (si aplica)

2.7. PestaÃ±a â€œConfiguraciÃ³nâ€

Marca:

âœ” Permitir que la tarea se ejecute a peticiÃ³n
âœ” Ejecutar la tarea lo antes posible despuÃ©s de que se haya omitido un inicio programado
âœ” (Opcional) Detener la tarea si se ejecuta mÃ¡s de: 8 horas

2.8. Guardar la tarea

Clic en Aceptar

Windows pedirÃ¡ usuario y contraseÃ±a
â†’ Ingresa un usuario administrador del servidor

Confirmar

ğŸŸ§ 3. PROBAR LA TAREA AUTOMÃTICA

En el Programador de Tareas:

Selecciona tu tarea

Panel derecho â†’ Ejecutar

Verifica el NAS para confirmar que:

Se crearon carpetas del mes

Carpeta del dÃ­a

ZIPs fueron copiados

No hay errores en el script

ğŸŸ¨ 4. Â¿CÃ“MO VER LAS TAREAS EXISTENTES?

Desde el Programador:

ğŸ“Œ Panel izquierdo â†’ Biblioteca del Programador de tareas

O desde PowerShell:

Get-ScheduledTask